<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>360video</title>
	<script type="text/javascript" src="js/three.min.js"></script>
	<script type="text/javascript" src="js/video.js"></script>
	<script src="https://cdn.jsdelivr.net/hls.js/latest/hls.min.js"></script>
	<style type="text/css">
		body{margin: 0;padding: 0;height: 100%;overflow: hidden;}
	</style>
</head>
<body>
	<script>
	  var browser=window.navigator.userAgent.toLowerCase();
      var panorama, viewer;
      // source/1234.mp4  http://www.streambox.fr/playlists/test_001/stream.m3u8
      if(browser.indexOf('mobile')>0){
      	 panorama = new PANOLENS.VideoPanorama( 'm3u8/index.m3u8', { autoplay: false,crossOrigin:true } );
      	 viewer = new PANOLENS.Viewer();
      	 viewer.add( panorama );
      }else{
      	var geometry = new THREE.SphereBufferGeometry( 500, 60, 40 );
			geometry.scale( - 1, 1, 1 );
		video = document.createElement( 'video' );
		if(Hls.isSupported()) {
		   var hls = new Hls();
		   var hlsaudio=new Hls(); 
		   // http://www.streambox.fr/playlists/test_001/stream.m3u8
		   hls.loadSource('http://cache.utovr.com/201508270528174780.m3u8');
		   hls.attachMedia (video);
		   hls.on(Hls.Events.MANIFEST_PARSED,function() {
		      video.play();
		   });
		}		

		var texture = new THREE.VideoTexture( video );
		texture.minFilter = THREE.LinearFilter;
		texture.format = THREE.RGBFormat;

		var material   = new THREE.MeshBasicMaterial( { map : texture } );

		mesh = new THREE.Mesh( geometry, material );    	

		viewer = new PANOLENS.Viewer();
		viewer.add( mesh ); 	
      }
      
      
    </script>
</body>
</html>